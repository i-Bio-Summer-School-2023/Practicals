function [LLH, BIC, AIC] = computeLLH_normal(y, ypred, k)
%Compute the log likelihood for a Gaussian model. y is the original signal;
%ypred, the model prediction and k is the total n

s2 = nanstd((y - ypred),1);
pdfun = normpdf(y,ypred,s2);
pdfun(pdfun == 0) = eps;
LLH = nansum(log(pdfun));

if nargin > 2
    N = numel(y);
    BIC = k * log(N) - 2 * LLH;
    AIC = 2 * k - 2 * LLH;
else
    BIC = NaN;
    AIC = NaN;
end
end