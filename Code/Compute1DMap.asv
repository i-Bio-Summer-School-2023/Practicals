function map = Compute1DMap(Xd, Z, nbins) %[mapModel, mapOcc] = ComputeMaps(Xd, Z, params)
%Compute 1D map efficiently. Xd is the binned independent varaible and Z is
%the dependent variable.

%Selecting valid indices
valididx = ~isnan(Xd);
Xd = Xd(valididx);
Z = Z(valididx);

%Summing Z within indices of Xd.
map = sparse(ones(size(Xd)), Xd, Z, 1, nbins);
map = full(map);

end